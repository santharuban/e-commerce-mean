{"ast":null,"code":"import _asyncToGenerator from \"/home/asplap3259/Desktop/e-commerce-mean/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { OrderComponent } from \"../order/order.component\";\nimport jwtDecode from \"jwt-decode\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/cart.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"../service/data.service\";\nimport * as i6 from \"@angular/common/http\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../header/header.component\";\nimport * as i9 from \"../shared/cart-sum.pipe\";\nfunction CartComponent_ng_container_3_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵelement(6, \"img\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 11)(10, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function CartComponent_ng_container_3_tr_20_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.decrease(item_r3));\n    });\n    i0.ɵɵtext(11, \"-\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\")(13, \"b\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function CartComponent_ng_container_3_tr_20_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.increase(item_r3));\n    });\n    i0.ɵɵtext(16, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(17, \"br\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"br\");\n    i0.ɵɵelementStart(19, \"td\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"td\")(22, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function CartComponent_ng_container_3_tr_20_Template_button_click_22_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.remove(item_r3._id));\n    });\n    i0.ɵɵtext(23, \" delete \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r4 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r3.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", item_r3.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r3.price);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(item_r3.quantity);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(item_r3.total);\n  }\n}\nfunction CartComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 3)(2, \"div\", 4)(3, \"div\", 5)(4, \"table\", 6)(5, \"thead\")(6, \"tr\")(7, \"th\");\n    i0.ɵɵtext(8, \"No\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Item name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Item image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\");\n    i0.ɵɵtext(16, \"quantity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\");\n    i0.ɵɵtext(18, \"total\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(19, \"tbody\");\n    i0.ɵɵtemplate(20, CartComponent_ng_container_3_tr_20_Template, 24, 6, \"tr\", 7);\n    i0.ɵɵelementStart(21, \"tr\")(22, \"td\", 8)(23, \"strong\");\n    i0.ɵɵtext(24);\n    i0.ɵɵpipe(25, \"sum\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(26, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function CartComponent_ng_container_3_Template_button_click_26_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.placeOrder());\n    });\n    i0.ɵɵtext(27, \" Place order \");\n    i0.ɵɵelementEnd()()()()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(20);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.cartData);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Total Amount :\", i0.ɵɵpipeBind2(25, 2, ctx_r0.cartData, \"total\"), \"\");\n  }\n}\nfunction CartComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 3)(2, \"div\", 15)(3, \"h3\");\n    i0.ɵɵtext(4, \"Add your items in the cart\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 16);\n    i0.ɵɵelement(6, \"img\", 17);\n    i0.ɵɵelementStart(7, \"h5\");\n    i0.ɵɵtext(8, \"Your cart is empty\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 18);\n    i0.ɵɵtext(10, \" SHOP NOW \");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nexport class CartComponent {\n  constructor(cart, router, toastrService, dialog, data, http) {\n    this.cart = cart;\n    this.router = router;\n    this.toastrService = toastrService;\n    this.dialog = dialog;\n    this.data = data;\n    this.http = http;\n    this.userCart = \"http://localhost:3000/api/usercart/userproduct\";\n  }\n  ngOnInit() {\n    const user = localStorage.getItem(\"user\");\n    if (user != null) {\n      this.decode = jwtDecode(user);\n      this.userId = this.decode.userId;\n    }\n    this.getCart();\n  }\n  getCart() {\n    console.log(\"jhgfdx\", this.userId);\n    this.http.get(`${this.userCart}/${this.userId}`).subscribe(res => {\n      this.cartData = res;\n      this.grandtotal = this.cart.getTotalPrice();\n    });\n  }\n  remove(item) {\n    this.http.delete(`${this.userCart}/${item}`).subscribe(() => {\n      this.toastrService.warning(\"Item deleted\");\n      this.getCart();\n    });\n  }\n  increase(data) {\n    if (data.quantity >= 10) {\n      this.toastrService.info(\"You can add upto 10 units only !\");\n      data.quantity = 10;\n    } else if (data.quantity >= 1) {\n      data.quantity++;\n      data.total = data.price * data.quantity;\n      this.http.put(`${this.userCart}/${data._id}`, data).subscribe(() => {\n        this.getCart();\n      }, err => {\n        this.toastrService.error(`${err.status} Error ${err.message}`);\n      });\n    }\n  }\n  decrease(data) {\n    if (data.quantity > 1) {\n      data.quantity--;\n      data.total = data.price * data.quantity;\n      this.http.put(`${this.userCart}/${data._id}`, data).subscribe(() => {\n        this.getCart();\n      }, err => {\n        this.toastrService.error(`${err.status} Error ${err.message}`);\n      });\n    } else if (data.quantity == 1) {\n      this.remove(data._id);\n    }\n  }\n  placeOrder() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      for (const element of _this.productitem) {\n        element.userId = _this.userId;\n        yield _this.data.addToCart(element).subscribe();\n      }\n      _this.dialog.open(OrderComponent);\n      setTimeout(() => {\n        _this.dialog.closeAll();\n        _this.cart.removeAll();\n      }, 3000);\n    })();\n  }\n}\nCartComponent.ɵfac = function CartComponent_Factory(t) {\n  return new (t || CartComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ToastrService), i0.ɵɵdirectiveInject(i4.MatDialog), i0.ɵɵdirectiveInject(i5.DataService), i0.ɵɵdirectiveInject(i6.HttpClient));\n};\nCartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CartComponent,\n  selectors: [[\"app-cart\"]],\n  decls: 5,\n  vars: 2,\n  consts: [[1, \"color\"], [\"id\", \"class\"], [4, \"ngIf\"], [1, \"container\"], [1, \"card-table\"], [1, \"cart-product\"], [1, \"table\", \"table-responsive\"], [4, \"ngFor\", \"ngForOf\"], [1, \"align\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [\"alt\", \"\", 2, \"width\", \"100px\", 3, \"src\"], [1, \"c\"], [1, \"a\", 3, \"click\"], [1, \"b\", 3, \"click\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"card\"], [1, \"center\"], [\"src\", \"../../assets/cart.png\", \"alt\", \"\"], [\"routerLink\", \"/products\", 1, \"btn\", \"btn-primary\"]],\n  template: function CartComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-header\");\n      i0.ɵɵelementStart(1, \"div\", 0)(2, \"body\", 1);\n      i0.ɵɵtemplate(3, CartComponent_ng_container_3_Template, 28, 5, \"ng-container\", 2);\n      i0.ɵɵtemplate(4, CartComponent_ng_container_4_Template, 11, 0, \"ng-container\", 2);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.cartData.length != 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.cartData.length == 0);\n    }\n  },\n  dependencies: [i7.NgForOf, i7.NgIf, i2.RouterLink, i8.HeaderComponent, i9.CartSumPipe],\n  styles: [\".card[_ngcontent-%COMP%] {\\n  height: 60px;\\n  margin: 25px;\\n  padding: 25px;\\n}\\n\\n.center[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  text-align: center;\\n}\\n\\n.card-table[_ngcontent-%COMP%] {\\n  position: relative;\\n  display: flex;\\n  flex-direction: column;\\n  min-width: none;\\n  word-wrap: break-word;\\n  background-clip: border-box;\\n  border: 1px solid black;\\n  background-image: linear-gradient(315deg, #deebdd 0%, #bbdbbe 74%);\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  padding-top: 150px;\\n}\\n\\n.align[_ngcontent-%COMP%] {\\n  margin-right: 2%;\\n}\\n\\n.color[_ngcontent-%COMP%] {\\n  background-image: linear-gradient(315deg, #98d9e1 0%, #d6aed6 74%);\\n}\\n\\n#class[_ngcontent-%COMP%] {\\n  background-image: linear-gradient(315deg, #485461 0%, #28313b 74%);\\n}\\n\\n.a[_ngcontent-%COMP%], .b[_ngcontent-%COMP%] {\\n  width: 30px;\\n  border-radius: 50%;\\n  padding: 5px;\\n}\\n\\n.c[_ngcontent-%COMP%] {\\n  padding: 5px;\\n  display: flex;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2FydC9jYXJ0LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxZQUFZO0VBQ1osWUFBWTtFQUNaLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixRQUFRO0VBQ1IsU0FBUztFQUNULGdDQUFnQztFQUNoQyxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLHNCQUFzQjtFQUN0QixlQUFlO0VBQ2YscUJBQXFCO0VBQ3JCLDJCQUEyQjtFQUMzQix1QkFBdUI7RUFDdkIsa0VBQWtFO0FBQ3BFOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0Usa0VBQWtFO0FBQ3BFOztBQUVBO0VBQ0Usa0VBQWtFO0FBQ3BFOztBQUVBOztFQUVFLFdBQVc7RUFDWCxrQkFBa0I7RUFDbEIsWUFBWTtBQUNkOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGFBQWE7QUFDZiIsInNvdXJjZXNDb250ZW50IjpbIi5jYXJkIHtcbiAgaGVpZ2h0OiA2MHB4O1xuICBtYXJnaW46IDI1cHg7XG4gIHBhZGRpbmc6IDI1cHg7XG59XG5cbi5jZW50ZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogNTAlO1xuICBsZWZ0OiA1MCU7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbi5jYXJkLXRhYmxlIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBtaW4td2lkdGg6IG5vbmU7XG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcbiAgYmFja2dyb3VuZC1jbGlwOiBib3JkZXItYm94O1xuICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbiAgYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KDMxNWRlZywgI2RlZWJkZCAwJSwgI2JiZGJiZSA3NCUpO1xufVxuXG4uY29udGFpbmVyIHtcbiAgcGFkZGluZy10b3A6IDE1MHB4O1xufVxuXG4uYWxpZ24ge1xuICBtYXJnaW4tcmlnaHQ6IDIlO1xufVxuXG4uY29sb3Ige1xuICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQoMzE1ZGVnLCAjOThkOWUxIDAlLCAjZDZhZWQ2IDc0JSk7XG59XG5cbiNjbGFzcyB7XG4gIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCgzMTVkZWcsICM0ODU0NjEgMCUsICMyODMxM2IgNzQlKTtcbn1cblxuLmEsXG4uYiB7XG4gIHdpZHRoOiAzMHB4O1xuICBib3JkZXItcmFkaXVzOiA1MCU7XG4gIHBhZGRpbmc6IDVweDtcbn1cblxuLmMge1xuICBwYWRkaW5nOiA1cHg7XG4gIGRpc3BsYXk6IGZsZXg7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["OrderComponent","jwtDecode","i0","CartComponent","constructor","cart","router","toastrService","dialog","data","http","ngOnInit","user","localStorage","getItem","decode","userId","getCart","console","log","get","userCart","subscribe","res","cartData","grandtotal","getTotalPrice","remove","item","delete","warning","increase","quantity","info","total","price","put","_id","err","error","status","message","decrease","placeOrder","element","productitem","addToCart","open","setTimeout","closeAll","removeAll","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/asplap3259/Desktop/e-commerce-mean/frontend/src/app/cart/cart.component.ts","/home/asplap3259/Desktop/e-commerce-mean/frontend/src/app/cart/cart.component.html"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport { Router } from \"@angular/router\";\nimport { CartService } from \"../service/cart.service\";\nimport { ToastrService } from \"ngx-toastr\";\nimport { products } from \"datatype\";\nimport { MatDialog } from \"@angular/material/dialog\";\nimport { OrderComponent } from \"../order/order.component\";\nimport { DataService } from \"../service/data.service\";\nimport { HttpClient } from \"@angular/common/http\";\nimport jwtDecode from \"jwt-decode\";\n@Component({\n  selector: \"app-cart\",\n  templateUrl: \"./cart.component.html\",\n  styleUrls: [\"./cart.component.css\"],\n})\nexport class CartComponent implements OnInit {\n  public cartData!: any;\n  public productitem: any;\n  public grandtotal!: number;\n  public userId:any\n  public decode:any\n  id!: number;\n  userCart = \"http://localhost:3000/api/usercart/userproduct\";\n  constructor(\n    private cart: CartService,\n    private router: Router,\n    private toastrService: ToastrService,\n    public dialog: MatDialog,\n    public data: DataService,\n    private http: HttpClient\n  ) {}\n  ngOnInit() {\n   const user = localStorage.getItem(\"user\")\n    if(user!=null){\n      this.decode=jwtDecode(user)\n      this.userId=this.decode.userId\n     }\n    this.getCart()\n\n  }\n\n  getCart() {\n    console.log(\"jhgfdx\",this.userId)\n    this.http\n      .get(`${this.userCart}/${this.userId}`)\n      .subscribe((res) => {\n        this.cartData = res;\n        this.grandtotal = this.cart.getTotalPrice();\n      });\n  }\n  remove(item: any) {\n \n    this.http.delete(`${this.userCart}/${item}`).subscribe(() => {\n      this.toastrService.warning(\"Item deleted\");\n      this.getCart();\n    });\n  }\n\n  increase(data: any) {\n    if (data.quantity >= 10) {\n      this.toastrService.info(\"You can add upto 10 units only !\");\n      data.quantity = 10;\n    } else if (data.quantity >= 1) {\n      data.quantity++;\n      data.total = data.price * data.quantity;\n      this.http.put(`${this.userCart}/${data._id}`, data).subscribe(\n        () => {\n          this.getCart();\n        },\n        (err: any) => {\n          this.toastrService.error(`${err.status} Error ${err.message}`);\n        }\n      );\n    }\n  }\n  decrease(data: any) {\n    if (data.quantity > 1) {\n      data.quantity--;\n      data.total = data.price * data.quantity;\n      this.http.put(`${this.userCart}/${data._id}`, data).subscribe(\n        () => {\n          this.getCart();\n        },\n        (err: any) => {\n          this.toastrService.error(`${err.status} Error ${err.message}`);\n        }\n      );\n    } else if (data.quantity == 1) {\n      this.remove(data._id);\n    }\n  }\n  async placeOrder() {\n    for (const element of this.productitem) {\n      element.userId =this.userId;\n      await this.data.addToCart(element).subscribe();\n    }\n    this.dialog.open(OrderComponent);\n    setTimeout(() => {\n      this.dialog.closeAll();\n      this.cart.removeAll();\n    }, 3000);\n  }\n}\n","<app-header></app-header>\n<div class=\"color\">\n  <body id=\"class\">\n    <ng-container *ngIf=\"cartData.length != 0\">\n      <div class=\"container\">\n        <div class=\"card-table\">\n          <div class=\"cart-product\">\n            <table class=\"table table-responsive\">\n              <thead>\n                <tr>\n                  <th>No</th>\n                  <th>Item name</th>\n                  <th>Item image</th>\n                  <th>price</th>\n                  <th>quantity</th>\n                  <th>total</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let item of cartData; let i = index\">\n                  <td>{{ i + 1 }}</td>\n                  <td>{{ item.title }}</td>\n                  <td>\n                    <img style=\"width: 100px\" src=\"{{ item.image }}\" alt=\"\" />\n                  </td>\n                  <td>{{ item.price }}</td>\n                  <div class=\"c\">\n                    <button class=\"a\" (click)=\"decrease(item)\">-</button>\n                    <td>\n                      <b>{{ item.quantity }}</b>\n                    </td>\n                    <button class=\"b\" (click)=\"increase(item)\">+</button><br />\n                  </div>\n                  <br />\n                  <td>{{ item.total }}</td>\n                  <td>\n                    <button (click)=\"remove(item._id)\" class=\"btn btn-danger\">\n                      delete\n                    </button>\n                  </td>\n                </tr>\n                <tr>\n                  <td class=\"align\">\n                    <strong\n                      >Total Amount :{{ cartData | sum : \"total\" }}</strong\n                    >\n                  </td>\n                  <button class=\"btn btn-primary\" (click)=\"placeOrder()\">\n                    Place order\n                  </button>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </ng-container>\n\n    <ng-container *ngIf=\"cartData.length == 0\">\n      <div class=\"container\">\n        <div class=\"card\">\n          <h3>Add your items in the cart</h3>\n        </div>\n        <div class=\"center\">\n          <img src=\"../../assets/cart.png\" alt=\"\" />\n          <h5>Your cart is empty</h5>\n          <button routerLink=\"/products\" class=\"btn btn-primary\">\n            SHOP NOW\n          </button>\n        </div>\n      </div>\n    </ng-container>\n  </body>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}